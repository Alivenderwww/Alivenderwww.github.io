{% extends "main.html" %}

{% block extrahead %}
  <style>
    body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        opacity: 0.3; /* 统一透明度 */
        z-index: -1;
    }
    .md-tabs{
        background: transparent;
    }
    .md-footer, .md-footer-meta {
        background: transparent;
    }
    @media screen and (min-width: 1220px) {
      .sidebar_nav {
        height: 0 !important;
      }
    }
    /* Spine Container Styling */
    #spine-container {
      /* 移除绝对定位，改用 Flexbox 布局在 md-grid 内部控制 */
      width: 600px; 
      height: 400px;
      /* 在 Flex 容器中靠右对齐 */
      margin-left: auto; 
      /* 垂直居中微调，视具体情况而定 */
      margin-top: auto;
      margin-bottom: auto;
    }

    /* 仅对 Canvas 应用矩形羽化，避免影响 UI 组件 */
    #spine-container canvas {
      /* 参考知乎文章实现矩形羽化：利用 mask-composite 合成水平和垂直的渐变遮罩 */
      /* 15px 是羽化半径，您可以根据需要调整 */
      -webkit-mask-image: linear-gradient(to right, transparent, black 15px, black calc(100% - 15px), transparent),
                          linear-gradient(to bottom, transparent, black 15px, black calc(100% - 15px), transparent);
      -webkit-mask-composite: source-in;
      
      mask-image: linear-gradient(to right, transparent, black 15px, black calc(100% - 15px), transparent),
                  linear-gradient(to bottom, transparent, black 15px, black calc(100% - 15px), transparent);
      mask-composite: intersect;
    }
    
    /* Hide on narrower screens */
    @media (max-width: 960px) {
      #spine-container {
        display: none;
      }
    }

    .md-main {
      display: flex;
      flex-direction: column;
    }
    .md-main__inner {
      display: flex;
      margin-top: 1.5rem;
      flex-direction: column;
      justify-content: space-between;
      height: 100%;
      width: 100%;
    }
    /* 确保 md-grid 能够容纳左右布局 */
    .home-grid-container {
      display: flex;
      align-items: center; /* 垂直居中 */
      justify-content: space-between; /* 左右分布 */
      width: 100%;
      height: 100%;
      position: relative;
    }
    .md-content {
      flex-grow: initial;
    }
    .md-content__inner {
      margin: 0 !important;
    }
    .md-header--shadow {
      box-shadow: none !important;
    }
  </style>
{% endblock %}

{% block site_nav %}
  <div style="display: none; flex-grow: 1;">
    <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" style="top: 0;">
      <div class="md-sidebar__scrollwrap sidebar_nav">
        <div class="md-sidebar__inner">
          {% include "partials/nav.html" %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block content %}
  <div class="md-typeset" style="display: block; background-color: transparent;">
    <div class="md-grid home-grid-container">
      <!-- 左侧内容 -->
      <div style="margin-left: 0.8rem; z-index: 1;">
        {{ page.content }}
      </div>
      
      <!-- 右侧 Spine Viewer -->
      <div id="spine-container">
        <div
          class="spine-player"
          data-id="452"
          data-alpha="false"
          data-scale="1"
          data-x="0"
          data-y="0"
          data-controls="true"
          style="width: 100%; height: 100%;"
        ></div>
      </div>
    </div>
  </div>
{% endblock %}