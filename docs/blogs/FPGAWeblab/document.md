---
title: '基于紫光同创FPGA的远程实验室-系统设计报告'
date: 2025-12-08 22:14
comment: True
comments: true
---

---
## 快速预览简介

我们基于双FPGA架构、Web前后端构建了高集成、可扩展的远程FPGA实验平台，支持用户通过Web界面远程或线下配置硬件、程序调试、实时监控、数据传输，实现“数字孪生”式实验教学。

**双FPGA架构**：Ctrl_FPGA——管理员控制核心，**单芯片**集成以太网通信、JTAG模拟、视频流DDR3缓存、电源管理、模拟信号抓取（DSO）、逻辑信号抓取（Analyzer）、模拟信号发送（DDS）等功能。Lab_FPGA——用户可编程FPGA，支持远程烧录Bitstream，线下配备的各类外设均可在线上同步操作和覆盖操作，提供与线下一致的实验体验。二者通过SFP高速互连，效率优于FPGA-单片机架构。支持虚拟外设静态配置，管理员可远程升级固件。

**AXI4-Full总线设计**：Ctrl_FPGA硬件设计使用AXI总线，支持跨时钟域、乱序执行、重排序、优先级仲裁，主频Fmax跨时钟域120MHz。标准化接口实现模块化设计，支持虚拟外设静态重分配。

**以太网-UDP协议栈**：实现AXI4总线与以太网的直接映射，支持千兆高速数据传输。支持ARP协议确定主机MAC，支持永久设定板卡IP和MAC。支持多端口并发，支持时间戳。

**MJPEG视频流编码**：Ctrl_FPGA内置JPEG编码器，支持最高2048x2048 YUV444编码为MJPEG视频流，支持动态调整压缩率，实现1:20倍传输视频流时的带宽节省。

**全功能JTAG模拟**：IEEE 1149.1标准，最高时钟50MHz，动态降频适配不同场景。后端集成BSDL解析，实现边界扫描、IDCODE、UID、状态寄存器获取、Bitstream下载等功能。

**丰富的外设配置**：系统配备了32位数码管、3组EC11旋转编码器、4x4矩阵机械键盘、5路拨码开关、一路用户可使用的AD、DA模块、1块128位WS2812灯排、1路HDMI-IN、1路HDMI-OUT、1块最高1366x768@60Hz规格的便携显示屏。**所有外设线下/线上均可操作/监看。**对于输入类外设，线上用户可以屏蔽线下操作，使用Web界面代替实物；对于输出类外设，线上用户可以实时在Web界面观察外设输出结果。

**工程化设计**：系统在设计时充分考虑实际生产应用。系统工作时仅需一根电源线和网线，支持电源管理，支持IP地址、MAC地址自动分配，支持EEPROM断电保存IP、MAC等板卡信息，支持ARP响应，支持port多端口并发，支持比特流校验等安全操作。后端支持多板卡管理，多线程管理，多任务管理。

**Web前后端系统**：后端（C# + SQLite）——用户管理、实验管理、提交管理、Bitstream校验、FPGA状态监控、安全烧录、实验板网络配置、逻辑分析仪、网络摄像头、HDMI采集、示波器、Debugger、等配置。前端（Vue3 + TypeScript）——图形化实验界面，支持画布自定义、文档查阅、实时信号可视化。

**完善的实验代码和文档**：目前已经完成6个基础实验和5个进阶实验以及1个基于SD卡的ISP处理平台的设计，每个实验配备完善的实验文档和rtl代码，为了方便用户使用，配备工程文件和仿真处理文件，方便用户使用和仿真。

实验系统的功能清单和实现方式如下表所示：

|基础和拓展功能|实现|说明|
|-|-|-|
|基础实验项目|✔|基础-01-流水灯<br/>基础-02-按键<br/>基础-03-数码管<br/>基础-04-矩阵键盘<br/>基础-05-呼吸灯<br/>基础-06-HDMI显示|
|高阶实验项目|✔|高阶-11-密码锁<br/>高阶-12-sfp通信<br/>高阶-13-频率计<br/>|
|远程下载|✔|以太网-FPGA-Jtag方案|
|远程固化|✔|以太网-FPGA-spi方案|
|远程调试|✔|自制Debugger核例化、抓取和调试已实现<br/>Web前后端正在适配Debugger功能<br/>|
|远程示波器|✔|线下可通过HDMI查看波形<br/>线上Web端可实时采集波形<br/>|
|远程信号发生器|✔|支持四路波形暂存<br/>支持频率相位调节<br/>Web可视化调节界面<br/>支持输入函数表达式<br/>支持dat文件上传<br/>|
|数字视频摄像头|✔|后端处理为Http视频流，实现网络摄像头功能<br/>支持自动对焦<br/>|
|远程逻辑分析仪|✔|支持8路采集、自定义深度、各类触发条件|
|数字孪生|✔|Jtag边界扫描捕获低频信号，部分硬件经过特殊设计，可通过以太网远程输出激励|
|远程登录及管理|✔|SQLite数据库管理|
|其他功能|说明|
|-|-|
|多板卡资源分配|后端数据库可注册多套板卡，并为每套系统分配唯一ID|
|断电记忆|通过EEPROM为每套系统分配IP、MAC，断电保存|
|Bootloader|板卡上电后自动读取固化信息并装载，随后进入工作模式|
|管理员模式|板卡处于管理员模式下时允许更多底层操作|
|HDMI采集||
|HDMI推流||
|实验管理、提交||
